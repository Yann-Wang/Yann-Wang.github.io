---
layout: post
title: Nginx作为Node.js前端Web Server的作用
date: 2017-02-03 
tags: [nginx, Node.js]
---

Nginx是一款由俄罗斯程序员Igor Sysoev开发的轻量级网页服务器、反向代理服务器及电子邮件（IMAP/POP3）
代理服务器。起初是供俄国大型门户网站及搜索引擎Rambler使用的，并因其稳定性、丰富的功能集、示例配置文件和
低系统资源的消耗而闻名。此软件在BSD-like协议下发行，可以在UNIX、GNU/Linux、BSD、Mac OS X、
Solaris及Windows等操作系统中运行。

这里正是看重了Nginx出色的HTTP反向代理能力，才把它放置在Node.js前端，用来处理我们的各种需求。

<!-- more -->

下面详细详细讲下Nginx作为Node.js前端Web Server的作用。

#### 静态文件性能

Node.js的静态文件处理性能受制于它的单线程异步I/O模型，注定了静态文件性能不会很好。在一台普通的4CPU
服务器上， 使用Nginx处理静态文件的性能基本上是纯Node.js的2倍以上， 所以我们应该避免在生产环境下
直接使用Node.js来处理静态文件。

#### 反向代理规则

有时会存在反向代理服务器配置多样化的情况， 有时我们希望配置较好的机器能够分担更多的压力， 有时又因为
session的关系， 我们需要将同一来源IP的客户端请求全转发到同一个进程上， 对于诸如此类的规则， 
使用Nginx的配置文件就可以简单实现。

#### 扩展性

Nginx可以加入许多扩展来帮助我们处理业务， 最典型的就是加入Lua语言的扩展。胶水语言Lua赋予了Nginx
复杂逻辑判断的能力， 并且保持了一贯的高效性。例如我们有一个API服务， 对访问会进行MD5签名或对同一
客户端来源有访问频率限制， 这部分代码是后端业务处理前必须通过的验证， 具有卡口的作用。 利用Lua扩展
， 我们就可以高效、 简单地完成这个卡口。

#### 稳定性和转发性能

对Nginx的稳定性， Nginx在同样的负载下， 相比Node.js占用的CPU和内存资源更少。 同时， 高效地
转发性能、便捷的转发配置也是选择它作为反向代理的原因之一。 比如可以根据不同的URL请求路径转发到不同的
后端机器上， 也可以设定超时时间等， 方便管理。

#### 安全性

经过一些配置， Nginx可以有效抵挡类似slowloris等的Dos攻击， 而Node.js在这方面做得还不够。

#### 运维管理

解决一台服务器上部署的多个站点同时需要占用80端口的问题。 通过Nginx反向代理配置， 将多个站点
域名指向一台机器， Nginx根据请求的域名转发到本地指定的端口。
 
所以， 在生产环境中， 永远把Nginx放置在Node.js的前端， 对性能、 安全性和将来的扩展都有益处。
  
<div class="references">References</div>

[Node.js实战（第2季）](https://book.douban.com/subject/26642320/)  


